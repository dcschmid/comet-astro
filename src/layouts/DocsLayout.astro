---
import BaseLayout from './BaseLayout.astro';
import ThemeToggle from '../components/ThemeToggle.astro';
import Headline from '../components/Headline.astro';
import Paragraph from '../components/Paragraph.astro';
import Prose from '../components/Prose.astro';
import Breadcrumbs from '../components/Breadcrumbs.astro';

interface Props {
  title: string;
  description?: string;
  /** Optional SEO overrides forwarded to BaseLayout */
  seoTitle?: string;
  seoDescription?: string;
  /** Wrap content slot in <Prose> component for consistent typography */
  prose?: boolean;
  /** Size scale forwarded to Headline component */
  headlineSize?: 'xs' | 'sm' | 'base' | 'lg' | 'xl' | '2xl' | '3xl' | '4xl';
  /** Paragraph size for description */
  descriptionSize?: 'xs' | 'sm' | 'md' | 'lg' | 'xl' | '2xl';
  /** Hide the default header (breadcrumbs, title, description) so a page can fully customize a hero section */
  hideHeader?: boolean;
  /** Show breadcrumbs even if header is shown (ignored when hideHeader=true) */
  showBreadcrumbs?: boolean;
}

const {
  title,
  description,
  seoTitle,
  seoDescription,
  prose = true,
  headlineSize = 'lg',
  descriptionSize = 'md',
  hideHeader = false,
  showBreadcrumbs = true,
} = Astro.props as Props;
// Padding logic handled directly by prose / header blocks now.

// (navGroups and currentSlug previously used in side navigation; removed to avoid unused variable warnings in this layout-only variant)

// Legacy nav overlay removed; BaseLayout provides structural slots.

// Derive breadcrumb items from path (simple: /components/<slug>)
const pathParts = Astro.url.pathname
  .replace(/\/$/, '')
  .split('/')
  .filter(Boolean);
const breadcrumbItems = [
  { href: '/', label: 'Home' },
  ...(pathParts[0] === 'components' ? [{ href: '', label: 'Components' }] : []),
  ...(pathParts[pathParts.length - 1] ? [{ label: title, current: true }] : []),
];
// Prefer explicit seoTitle/seoDescription when provided; otherwise derive from title/description.
const resolvedSeoTitle = seoTitle ? seoTitle : `${title} – Comet Astro`;
const resolvedSeoDescription = seoDescription ? seoDescription : description;
---

// Prefer explicit seoTitle/seoDescription when provided; otherwise derive from
title/description. const resolvedSeoTitle = seoTitle ? seoTitle : `${title} – Comet
Astro`; const resolvedSeoDescription = seoDescription ? seoDescription : description;

<BaseLayout
  seoTitle={resolvedSeoTitle}
  seoDescription={resolvedSeoDescription}
  containerSize="lg"
>
  <div slot="theme"><ThemeToggle /></div>
  {
    !hideHeader && (
      <header class="mb-8 space-y-3">
        {showBreadcrumbs && <Breadcrumbs items={breadcrumbItems} />}
        <Headline
          level="h1"
          textSize={headlineSize}
          weight="extrabold"
          maxWidth="none"
          textAlign="center"
          className="text-slate-900 dark:text-slate-50"
        >
          {title}
        </Headline>
        {description && (
          <Paragraph
            size={descriptionSize}
            variant="muted"
            maxWidth="prose"
            class="md:text-lg"
            align="center"
          >
            {description}
          </Paragraph>
        )}
      </header>
    )
  }
  {
    prose ? (
      <Prose variant="default" size="md" maxWidth="lg" class="mb-10">
        <slot name="showcase" />
      </Prose>
    ) : (
      <slot name="showcase" />
    )
  }
  {
    prose ? (
      <Prose variant="article" size="lg" maxWidth="xl" readingMode={true}>
        <slot />
      </Prose>
    ) : (
      <slot />
    )
  }
</BaseLayout>
