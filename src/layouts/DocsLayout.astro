---
import BaseLayout from './BaseLayout.astro';
import ThemeToggle from '../components/ThemeToggle.astro';
// Headline removed — header now shows a back-link instead of the page title.
import Prose from '../components/Prose.astro';
import { Astro } from 'astro';
import Container from '../components/Container.astro';

interface Props {
  title: string;
  description?: string;
  /** Optional SEO overrides forwarded to BaseLayout */
  seoTitle?: string;
  seoDescription?: string;
  /** Wrap content slot in <Prose> component for consistent typography */
  prose?: boolean;
  /** Paragraph size for description */
  descriptionSize?: 'xs' | 'sm' | 'md' | 'lg' | 'xl' | '2xl';
  /** Hide the default header (breadcrumbs, title, description) so a page can fully customize a hero section */
  hideHeader?: boolean;
  /** Show breadcrumbs even if header is shown (ignored when hideHeader=true) */
  // breadcrumbs removed — header contains a back-link now
}

const {
  title,
  description,
  seoTitle,
  seoDescription,
  prose = true,
  hideHeader = false,
} = Astro.props as Props;

const resolvedSeoTitle = seoTitle ? seoTitle : `${title} – Comet Astro`;
const resolvedSeoDescription = seoDescription ? seoDescription : description;
const resolvedContainerSize = 'lg';
---

<BaseLayout
  seoTitle={resolvedSeoTitle}
  seoDescription={resolvedSeoDescription}
  containerSize="lg"
  title={title}
>
  <div slot="header">
    {
      !hideHeader && (
        <header class="mb-8">
          <Container
            size={resolvedContainerSize}
            className="flex flex-col md:flex-row items-center md:items-center gap-4 md:justify-between"
          >
            <div className="min-w-0 text-center md:text-left">
              <a
                href="/"
                class="inline-flex items-center gap-3 text-sm text-slate-700 dark:text-slate-300 hover:text-sky-600"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="text-slate-700 dark:text-slate-200"
                >
                  <>
                    <path d="M19 12H6" />
                    <path d="M12 19L5 12 12 5" />
                  </>
                </svg>
                <span>Back</span>
              </a>
            </div>
            <div className="flex items-center justify-center md:justify-end">
              <ThemeToggle />
            </div>
          </Container>
        </header>
      )
    }
  </div>
  <div slot="main">
    {
      prose ? (
        <Prose variant="default" size="md" maxWidth="lg" class="mb-10">
          <slot name="showcase" />
        </Prose>
      ) : (
        <slot name="showcase" />
      )
    }
    {
      prose ? (
        <Prose variant="article" size="lg" maxWidth="xl" readingMode={true}>
          <slot />
        </Prose>
      ) : (
        <slot />
      )
    }
  </div>
</BaseLayout>
