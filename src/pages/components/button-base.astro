---
import DocsLayout from '../../layouts/DocsLayout.astro';
import ButtonBase from '../../components/ButtonBase.astro';
import Paragraph from '../../components/Paragraph.astro';
import Headline from '../../components/Headline.astro';
import Table from '../../components/Table.astro';
import CodeBlock from '../../components/CodeBlock.astro';

const usageSnippet = `---
import { ButtonBase } from 'comet-astro';
---

<!-- Render as button -->
<ButtonBase 
  as="button"
  variant="primary"
  size="md"
  type="submit"
>
  Submit Form
</ButtonBase>

<!-- Render as anchor -->
<ButtonBase 
  as="a"
  href="https://example.com"
  variant="secondary"
  size="lg"
  external={true}
>
  Visit Website
</ButtonBase>`;

const propsColumns = [
  { key: 'prop', label: 'Prop' },
  { key: 'type', label: 'Type' },
  { key: 'default', label: 'Default' },
  { key: 'description', label: 'Description' },
];

const propsData = [
  {
    prop: 'as',
    type: "'button' | 'a'",
    default: "'button'",
    description:
      'Element type to render; affects available props like href and type.',
  },
  {
    prop: 'variant',
    type: "'primary' | 'secondary' | 'ghost' | 'success' | 'destructive' | 'warning' | 'cyan' | 'teal' | 'purple' | 'indigo' | 'info'",
    default: "'primary'",
    description:
      'Visual style variant used for colors and focus rings. Provides Light and Dark mode variants.',
  },
  {
    prop: 'size',
    type: "'sm' | 'md' | 'lg'",
    default: "'md'",
    description: 'Control sizing and padding.',
  },
  {
    prop: 'loading',
    type: 'boolean',
    default: 'false',
    description:
      'Displays spinner, sets <code>aria-busy</code>, and applies loading styles.',
  },
  {
    prop: 'loadingLabel',
    type: 'string',
    default: "'Loading'",
    description: 'Accessible label read by screen readers while loading.',
  },
  {
    prop: 'class',
    type: 'string',
    default: '—',
    description:
      'Additional Tailwind utility classes merged with computed classes (useful for one-off overrides).',
  },
  {
    prop: 'ariaLabel',
    type: 'string',
    default: '—',
    description:
      'Accessible name for the button/link; when present, icons are treated as decorative.',
  },
  {
    prop: 'disabled',
    type: 'boolean',
    default: 'false',
    description: 'Disables interaction and applies disabled styles.',
  },
  {
    prop: 'icon',
    type: 'string',
    default: '—',
    description:
      'Optional icon name for the <code>Icon</code> component. Renders before the content.',
  },
  {
    prop: 'href',
    type: 'string',
    default: '—',
    description:
      "Destination for anchor rendering (only when <code>as='a'</code>).",
  },
  {
    prop: 'target',
    type: "'_blank' | '_self' | '_parent' | '_top'",
    default: "'_self'",
    description:
      "Specifies where to open the linked document when using <code>as='a'</code>.",
  },
  {
    prop: 'rel',
    type: 'string',
    default: '—',
    description:
      'Rel attribute for anchors; <code>noopener noreferrer</code> is added automatically for external links.',
  },
  {
    prop: 'external',
    type: 'boolean',
    default: 'auto',
    description:
      'Force or suppress external link behavior. If omitted, external links are detected automatically.',
  },
  {
    prop: 'externalLabel',
    type: 'string',
    default: "'opens in new window'",
    description: 'Screen reader text appended for external links.',
  },
  {
    prop: 'id',
    type: 'string',
    default: '—',
    description:
      'Optional DOM id attribute for JS hooks or targeting in tests.',
  },
];

const tvSnippet = `// In your app: create a small helper using tailwind-variants
import { tv } from 'tailwind-variants';

// Define the tokens you need for your project (copy/adapt from ButtonBase as desired)
export const myButton = tv({
  base: 'inline-flex items-center justify-center rounded-lg font-semibold no-underline transition-colors duration-150',
  variants: {
    variant: {
      primary: 'border border-blue-900 bg-blue-950 text-blue-50',
      success: 'border border-green-900 bg-green-950 text-green-50',
    },
    size: {
      sm: 'h-9 px-3 text-sm',
      md: 'h-10 px-4 text-sm',
      lg: 'h-12 px-6 text-base',
    },
  },
  defaultVariants: { variant: 'primary', size: 'md' },
});

// Compose a preset and merge additional utilities via the \`class\` option
const fancy = myButton({
  variant: 'primary',
  size: 'lg',
  class: 'bg-gradient-to-r from-purple-500 to-indigo-500 text-white dark:from-purple-700 dark:to-indigo-700',
});

// Pass the computed classes to the component's \`class\` prop
<ButtonBase as="button" class={fancy}>Fancy</ButtonBase>`;
---

<DocsLayout
  seoTitle="ButtonBase"
  seoDescription="Shared styling and logic foundation for Button and ButtonLink components with consistent appearance, accessibility, and external link handling."
>
  <section class="space-y-4">
    <Paragraph class="text-base text-slate-100">
      ButtonBase is the foundational component that powers both Button and
      ButtonLink, providing consistent styling, accessibility features, and
      behavior across all button-like interactions in Comet.
    </Paragraph>
    <Paragraph class="text-base text-slate-200">
      This component ensures WCAG AAA compliance with 9:1 contrast ratios,
      proper focus indicators, and intelligent external link detection while
      maintaining a unified design system across button variants.
    </Paragraph>
    <Paragraph class="text-base text-slate-200">
      <strong>Note:</strong> ButtonBase is typically used internally by Button and
      ButtonLink components rather than directly in applications. For most use cases,
      use Button or ButtonLink instead.
    </Paragraph>
  </section>

  <section id="props" class="space-y-4">
    <Headline level="h2">Props</Headline>

    <div
      class="prose max-w-none text-sm leading-relaxed text-slate-700 dark:text-slate-300 space-y-3"
    >
      <Table columns={propsColumns} data={propsData} responsive={true} />
    </div>
  </section>

  <section class="mt-10 space-y-6">
    <Headline level="h2" class="text-xl font-semibold text-slate-100"
      >Architecture Benefits</Headline
    >
    <Paragraph class="text-base text-slate-200">
      ButtonBase provides shared functionality that ensures consistency across
      button components:
    </Paragraph>
    <ul class="list-disc pl-6 space-y-1 text-slate-200">
      <li>
        <strong>Code Reduction:</strong> ~60% reduction in duplicate styling between
        Button and ButtonLink
      </li>
      <li>
        <strong>Consistent Styling:</strong> Unified appearance across all button
        variants and sizes
      </li>
      <li>
        <strong>Intelligent Rendering:</strong> Proper element type based on use
        case (button vs anchor)
      </li>
      <li>
        <strong>External Link Detection:</strong> Automatic icon and attributes for
        external URLs
      </li>
      <li>
        <strong>Accessibility Compliance:</strong> WCAG AAA standards with proper
        ARIA attributes
      </li>
      <li>
        <strong>Focus Management:</strong> Consistent focus indicators and keyboard
        navigation
      </li>
    </ul>
  </section>

  <section class="mt-10 space-y-6">
    <Headline level="h2" class="text-xl font-semibold text-slate-100"
      >Overriding styles</Headline
    >
    <Paragraph class="text-base text-slate-200">
      Because ButtonBase is powered by <code>tailwind-variants</code>, you can
      override styles in two ways: a) via the <code>class</code> prop which will
      be merged with the computed classes, or b) by importing
      <code>buttonVariants</code> to compute custom presets. If your project supports
      dark mode, include <code>dark:...</code> utilities when overriding colors to
      ensure the override appears correctly in both themes.
    </Paragraph>

    <Headline level="h3" class="text-lg font-medium text-slate-100"
      >Inline class prop</Headline
    >
    <Paragraph class="text-sm text-slate-200"
      >Add utilities for one-off overrides.</Paragraph
    >
    <div class="flex gap-3">
      <ButtonBase
        as="button"
        class="bg-amber-600 border-amber-600 text-white dark:bg-amber-700 dark:border-amber-700"
        >Amber</ButtonBase
      >
      <ButtonBase
        as="button"
        variant="ghost"
        class="text-emerald-400 dark:text-emerald-300">Emerald Ghost</ButtonBase
      >
    </div>

    <Headline level="h3" class="text-lg font-medium text-slate-100"
      >Programmatic composition</Headline
    >
    <Paragraph class="text-sm text-slate-200"
      >Create new presets in code by composing a local <code>tv</code> helper — the
      library keeps its internal <code>buttonVariants</code> inside <code
        >ButtonBase</code
      >, so you should define a small helper in your app to compute classes for
      custom presets.</Paragraph
    >
    <CodeBlock language="ts" code={tvSnippet} />
  </section>

  <section class="mt-10 space-y-8">
    <Headline level="h2" class="text-xl font-semibold text-slate-100"
      >Visual Variants</Headline
    >
    <div class="grid gap-6 lg:grid-cols-3">
      <!-- Primary Variant -->
      <div class="space-y-3">
        <Headline level="h3" class="text-lg font-medium text-slate-100"
          >Primary</Headline
        >
        <Paragraph class="text-sm text-slate-300">
          High-contrast variant for primary actions
        </Paragraph>
        <ButtonBase as="button" variant="primary" size="md">
          Primary Action
        </ButtonBase>
      </div>

      <!-- Secondary Variant -->
      <div class="space-y-3">
        <Headline level="h3" class="text-lg font-medium text-slate-100"
          >Secondary</Headline
        >
        <Paragraph class="text-sm text-slate-300">
          Subtle variant for secondary actions
        </Paragraph>
        <ButtonBase as="button" variant="secondary" size="md">
          Secondary Action
        </ButtonBase>
      </div>

      <!-- Ghost Variant -->
      <div class="space-y-3">
        <Headline level="h3" class="text-lg font-medium text-slate-100"
          >Ghost</Headline
        >
        <Paragraph class="text-sm text-slate-300">
          Minimal variant for tertiary actions
        </Paragraph>
        <ButtonBase as="button" variant="ghost" size="md">
          Ghost Action
        </ButtonBase>
      </div>
    </div>
  </section>

  <section class="mt-12 space-y-6">
    <Headline level="h2" class="text-xl font-semibold text-slate-100"
      >Variant Gallery (Light / Dark)</Headline
    >
    <Paragraph class="text-sm text-slate-300"
      >Preview each variant in both light and dark contexts. Use the copy button
      to grab the variant class snippet.</Paragraph
    >

    <div class="grid gap-6 md:grid-cols-2">
      <!-- Light Preview -->
      <div
        class="rounded-lg border border-slate-700/60 bg-white p-6 text-slate-900"
      >
        <Headline level="h3" class="text-lg font-medium mb-3 text-slate-900"
          >Light Mode</Headline
        >
        <div class="flex flex-wrap gap-3">
          <ButtonBase as="button" variant="primary">Primary</ButtonBase>
          <ButtonBase as="button" variant="success">Success</ButtonBase>
          <ButtonBase as="button" variant="destructive">Delete</ButtonBase>
          <ButtonBase as="button" variant="warning">Warning</ButtonBase>
          <ButtonBase as="button" variant="info">Info</ButtonBase>
          <ButtonBase as="button" variant="secondary">Secondary</ButtonBase>
          <ButtonBase as="button" variant="ghost">Ghost</ButtonBase>
          <ButtonBase as="button" variant="cyan">Cyan</ButtonBase>
          <ButtonBase as="button" variant="teal">Teal</ButtonBase>
          <ButtonBase as="button" variant="purple">Purple</ButtonBase>
          <ButtonBase as="button" variant="indigo">Indigo</ButtonBase>
        </div>
      </div>

      <!-- Dark Preview -->
      <div
        class="rounded-lg border border-slate-700/60 bg-slate-900 p-6 text-slate-50"
      >
        <Headline level="h3" class="text-lg font-medium mb-3"
          >Dark Mode</Headline
        >
        <div class="flex flex-wrap gap-3">
          <div class="dark">
            <ButtonBase as="button" variant="primary">Primary</ButtonBase>
            <ButtonBase as="button" variant="success">Success</ButtonBase>
            <ButtonBase as="button" variant="destructive">Delete</ButtonBase>
            <ButtonBase as="button" variant="warning">Warning</ButtonBase>
            <ButtonBase as="button" variant="info">Info</ButtonBase>
            <ButtonBase as="button" variant="secondary">Secondary</ButtonBase>
            <ButtonBase as="button" variant="ghost">Ghost</ButtonBase>
            <ButtonBase as="button" variant="cyan">Cyan</ButtonBase>
            <ButtonBase as="button" variant="teal">Teal</ButtonBase>
            <ButtonBase as="button" variant="purple">Purple</ButtonBase>
            <ButtonBase as="button" variant="indigo">Indigo</ButtonBase>
          </div>
        </div>
      </div>
    </div>

    <div class="prose max-w-none">
      <Headline level="h4">Copyable snippets</Headline>
      <CodeBlock
        language="html"
        code={`<ButtonBase as="button" variant="primary">Primary</ButtonBase>`}
        className="overflow-x-auto rounded-lg border border-slate-700/70 bg-slate-950/80 p-4 text-sm text-slate-50"
      />
      <CodeBlock
        language="html"
        code={`<ButtonBase as="button" variant="warning">Warning</ButtonBase>`}
        className="overflow-x-auto rounded-lg border border-slate-700/70 bg-slate-950/80 p-4 text-sm text-slate-50"
      />
    </div>
  </section>

  <section class="mt-8 space-y-3">
    <Headline level="h3" class="text-base font-semibold text-slate-100"
      >Icon example</Headline
    >
    <Paragraph class="text-sm text-slate-200"
      >Use the simple <code>icon</code> prop for common cases. The icon will be announced
      when no <code>ariaLabel</code> is provided; when you pass an <code
        >ariaLabel</code
      >, the icon is treated as decorative.</Paragraph
    >
    <div class="flex gap-3">
      <ButtonBase as="button" icon="plus">Add</ButtonBase>
      <ButtonBase as="button" variant="secondary" icon="check">Saved</ButtonBase
      >
      <ButtonBase as="button" variant="ghost" icon="x">Cancel</ButtonBase>
    </div>
  </section>

  <section class="mt-10 space-y-8">
    <Headline level="h2" class="text-xl font-semibold text-slate-100"
      >Size Variants</Headline
    >
    <div class="flex flex-wrap items-center gap-3">
      <ButtonBase as="button" variant="primary" size="sm">Small</ButtonBase>
      <ButtonBase as="button" variant="primary" size="md">Medium</ButtonBase>
      <ButtonBase as="button" variant="primary" size="lg">Large</ButtonBase>
    </div>
  </section>

  <section class="mt-10 space-y-8">
    <Headline level="h2" class="text-xl font-semibold text-slate-100"
      >Element Types</Headline
    >
    <div class="grid gap-6 lg:grid-cols-2">
      <!-- Button Element -->
      <div class="space-y-3">
        <Headline level="h3" class="text-lg font-medium text-slate-100"
          >Button Element</Headline
        >
        <Paragraph class="text-sm text-slate-300">
          For form submissions and interactive actions
        </Paragraph>
        <div class="space-y-2">
          <ButtonBase as="button" type="button" variant="primary">
            Interactive Button
          </ButtonBase>
          <ButtonBase as="button" type="submit" variant="secondary">
            Submit Form
          </ButtonBase>
          <ButtonBase as="button" disabled variant="ghost">
            Disabled Button
          </ButtonBase>
        </div>
      </div>

      <!-- Anchor Element -->
      <div class="space-y-3">
        <Headline level="h3" class="text-lg font-medium text-slate-100"
          >Anchor Element</Headline
        >
        <Paragraph class="text-sm text-slate-300"
          >For navigation and external links</Paragraph
        >
        <div class="space-y-2">
          <ButtonBase as="a" href="/docs" variant="primary">
            Internal Link
          </ButtonBase>
          <ButtonBase
            as="a"
            href="https://example.com"
            target="_blank"
            variant="secondary"
          >
            External Link
          </ButtonBase>
          <ButtonBase as="a" href="mailto:contact@example.com" variant="ghost">
            Email Link
          </ButtonBase>
        </div>
      </div>
    </div>
  </section>

  <section class="mt-10 space-y-8">
    <Headline level="h2" class="text-xl font-semibold text-slate-100">
      External Link Detection
    </Headline>
    <Paragraph class="text-base text-slate-200">
      ButtonBase automatically detects external links and applies appropriate
      styling and attributes:
    </Paragraph>
    <div class="space-y-4">
      <div class="space-y-2">
        <Headline level="h4" class="font-medium text-slate-200"
          >Automatic Detection</Headline
        >
        <div class="flex gap-3">
          <ButtonBase as="a" href="https://astro.build" variant="primary">
            Astro Website
          </ButtonBase>
          <ButtonBase as="a" href="/docs/components" variant="secondary">
            Internal Docs
          </ButtonBase>
        </div>
      </div>

      <div class="space-y-2">
        <Headline level="h4" class="font-medium text-slate-200"
          >Manual Override</Headline
        >
        <div class="flex gap-3">
          <ButtonBase
            as="a"
            href="/relative-path"
            external={true}
            variant="primary"
          >
            Force External Style
          </ButtonBase>
          <ButtonBase
            as="a"
            href="https://example.com"
            external={false}
            variant="secondary"
          >
            Suppress External Style
          </ButtonBase>
        </div>
      </div>
    </div>
  </section>

  <section class="mt-10 space-y-6">
    <Headline level="h2" class="text-xl font-semibold text-slate-100"
      >Usage</Headline
    >
    <Paragraph class="text-base text-slate-200">
      While ButtonBase can be used directly for custom implementations, it's
      recommended to use Button or ButtonLink components which provide optimized
      configurations for common use cases.
    </Paragraph>
    <CodeBlock
      language="astro"
      code={usageSnippet}
      className="overflow-x-auto rounded-lg border border-slate-700/70 bg-slate-950/80 p-4 text-sm text-slate-50 shadow-inner"
    />
  </section>

  <section class="mt-10 space-y-4">
    <Headline level="h2" class="text-xl font-semibold text-slate-100">
      Components Using ButtonBase
    </Headline>
    <Paragraph class="text-base text-slate-200">
      The following components are built on top of ButtonBase:
    </Paragraph>
    <div class="grid gap-3 sm:grid-cols-2">
      <div
        class="rounded-lg border border-slate-700/75 bg-slate-900/60 p-3 text-sm"
      >
        <strong class="text-slate-200">Button</strong>
        <Paragraph class="text-slate-400">
          Intelligent button/link component with auto-detection
        </Paragraph>
      </div>
      <div
        class="rounded-lg border border-slate-700/75 bg-slate-900/60 p-3 text-sm"
      >
        <strong class="text-slate-200">ButtonLink</strong>
        <Paragraph class="text-slate-400"
          >Dedicated anchor-style button component</Paragraph
        >
      </div>
    </div>
  </section>

  <section class="mt-10 space-y-4">
    <Headline level="h2" class="text-xl font-semibold text-slate-100"
      >Accessibility Features</Headline
    >
    <Paragraph class="text-base text-slate-200">
      ButtonBase ensures WCAG AAA compliance across all button components with:
    </Paragraph>
    <ul class="list-disc pl-6 space-y-1 text-slate-200">
      <li>
        9:1 contrast ratios in all variants and states (hover, focus, disabled)
      </li>
      <li>4px focus rings with theme-appropriate offsets for visibility</li>
      <li>Proper ARIA attributes and semantic HTML structure</li>
      <li>Keyboard navigation support with visible focus indicators</li>
      <li>
        Screen reader announcements for external links and disabled states
      </li>
      <li>High contrast mode compatibility with enhanced borders</li>
      <li>Proper button/anchor semantics based on element type</li>
    </ul>
  </section>

  <section class="mt-10 space-y-4">
    <Headline level="h2" class="text-xl font-semibold text-slate-100"
      >Styling System</Headline
    >
    <Paragraph class="text-base text-slate-200">
      ButtonBase provides a comprehensive styling system with:
    </Paragraph>
    <ul class="list-disc pl-6 space-y-1 text-slate-200">
      <li>
        <strong>Three Variants:</strong> Primary, secondary, and ghost with distinct
        visual hierarchy
      </li>
      <li>
        <strong>Three Sizes:</strong> Small (sm), medium (md), and large (lg) with
        proportional spacing
      </li>
      <li>
        <strong>State Variants:</strong> Default, hover, focus, and disabled states
        with smooth transitions
      </li>
      <li>
        <strong>Theme Compatibility:</strong> Proper colors for both light and dark
        themes
      </li>
      <li>
        <strong>External Link Icons:</strong> Automatic icon placement with proper
        spacing
      </li>
      <li>
        <strong>Responsive Design:</strong> Consistent appearance across different
        screen sizes
      </li>
    </ul>
  </section>

  <section class="mt-10 space-y-4">
    <Headline level="h2" class="text-xl font-semibold text-slate-100"
      >Implementation Details</Headline
    >
    <div class="space-y-3">
      <div class="rounded-lg border border-slate-700/75 bg-slate-900/60 p-4">
        <Headline level="h4" class="font-medium text-slate-200 mb-2"
          >Element Selection Logic</Headline
        >
        <ul class="list-disc pl-4 space-y-1 text-sm text-slate-300">
          <li>
            <code>as="button"</code>: Renders <code>&lt;button&gt;</code> element
            with proper type and form attributes
          </li>
          <li>
            <code>as="a"</code>: Renders <code>&lt;a&gt;</code> element with href,
            target, and rel attributes
          </li>
          <li>
            Automatic <code>rel="noopener noreferrer"</code> for external links with
            <code>target="_blank"</code>
          </li>
        </ul>
      </div>

      <div class="rounded-lg border border-slate-700/75 bg-slate-900/60 p-4">
        <Headline level="h4" class="font-medium text-slate-200 mb-2"
          >External Link Detection</Headline
        >
        <ul class="list-disc pl-4 space-y-1 text-sm text-slate-300">
          <li>
            Automatic detection for URLs starting with <code>http://</code>, <code
              >https://</code
            >, or <code>mailto:</code>
          </li>
          <li>
            Manual override with <code>external</code> prop for custom behavior
          </li>
          <li>
            External link icon automatically added with proper ARIA labels
          </li>
        </ul>
      </div>
    </div>
  </section>
</DocsLayout>
