---
import DocsLayout from '../../layouts/DocsLayout.astro';
import AudioPlayer from '../../components/AudioPlayer.astro';
import Table from '../../components/Table.astro';
import Headline from '../../components/Headline.astro';
import Paragraph from '../../components/Paragraph.astro';
import InlineCode from '../../components/InlineCode.astro';
import CodeBlock from '../../components/CodeBlock.astro';

const fullTrack = {
  src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3',
  title: 'Night Drive',
  artist: 'SoundHelix',
  cover:
    'https://images.unsplash.com/photo-1524678606370-a47ad25cb82a?auto=format&fit=crop&w=400&q=80',
};

const compactTrack = {
  src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3',
  title: 'Golden Hour',
  artist: 'Kinetic Bloom  ',
  cover:
    'https://images.unsplash.com/photo-1483412033650-1015ddeb83d1?auto=format&fit=crop&w=400&q=80',
};

const bareTrack = {
  src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-8.mp3',
  title: 'Ambient Waves',
};

const wideTrack = {
  src: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-10.mp3',
  title: 'City Lights (Live Session)',
  artist: 'Aurora North',
  cover:
    'https://images.unsplash.com/photo-1470229722913-7c0e2dbbafd3?auto=format&fit=crop&w=1200&q=80',
};

const transcriptVtt = `WEBVTT\n\n00:00.000 --> 00:07.000\nWelcome to tonight's session.\n\n00:07.000 --> 00:14.000\nWe are exploring the new audio player transcript feature.\n\n00:14.000 --> 00:22.000\nUse the highlights to jump to any moment in the recording.\n`;

const transcriptDataUrl = `data:text/vtt;charset=utf-8,${encodeURIComponent(transcriptVtt)}`;

const usageSnippet = `---
import { AudioPlayer } from 'comet-astro';

const track = {
  src: 'https://example.com/audio.mp3',
  title: 'Interview with the team',
  artist: 'Accessible Design',
  cover: '/covers/podcast.jpg',
  captions: '/audio/interview.vtt',
};

---

<AudioPlayer
  src={track.src}
  title={track.title}
  artist={track.artist}
  cover={track.cover}
  coverAspect="wide"
  captionsSrc={track.captions}
  captionsLabel="Interview transcript"
  className="max-w-md"
/>`;

const propsColumns = [
  { key: 'name', label: 'Prop' },
  { key: 'type', label: 'Type' },
  { key: 'default', label: 'Default' },
  { key: 'description', label: 'Description' },
];

const propsData = [
  {
    name: 'src',
    type: 'string',
    default: "''",
    description:
      'Audio URL passed straight to the audio element. Supports streamed MP3, OGG, or other browser-compatible formats.',
  },
  {
    name: 'title',
    type: 'string',
    default: "''",
    description:
      'Track title displayed above the controls and used as part of the accessible label.',
  },
  {
    name: 'artist',
    type: 'string',
    default: "''",
    description: 'Secondary text for the performer, podcast, or album name.',
  },
  {
    name: 'cover',
    type: 'string',
    default: "''",
    description:
      'Cover art URL rendered as rounded media. Provide an alt description by setting title; otherwise a generic label is used.',
  },
  {
    name: 'autoplay',
    type: 'boolean',
    default: 'false',
    description:
      'Boolean flag that forwards to audio. Disabled by default for respect of user preferences.',
  },
  {
    name: 'loop',
    type: 'boolean',
    default: 'false',
    description:
      'Plays the audio on repeat when true. Ideal for background ambience or short clips.',
  },
  {
    name: 'variant',
    type: '"full" | "compact" | string',
    default: 'full',
    description:
      'Choose "full" (default) for artwork and metadata or "compact" for a streamlined bar layout.',
  },
  {
    name: 'coverAspect',
    type: '"square" | "wide"',
    default: 'square',
    description:
      'Set to "wide" to render 16:9 media on the full variant. Defaults to "square".',
  },
  {
    name: 'captionsSrc',
    type: 'string',
    default: "''",
    description:
      'Optional WebVTT source used to populate a collapsible transcript beneath the controls. Clickable cues keep playback in sync.',
  },
  {
    name: 'captionsLabel',
    type: 'string',
    default: '"Transcript"',
    description:
      'Custom text for the transcript toggle button. Defaults to "Transcript".',
  },
  {
    name: 'className',
    type: 'string',
    default: "''",
    description:
      'Extra Tailwind utilities merged onto the root element. Use this to cap width or align the player within your layout.',
  },
];
---

<DocsLayout
  seoTitle="AudioPlayer"
  seoDescription="Accessible audio player with keyboard-friendly controls, time display, and optional artwork."
>
  <Headline level="h1" textSize="2xl">Audio Player</Headline>

  <section class="space-y-4">
    <Paragraph className="text-base text-slate-100">
      The audio player wraps the native <InlineCode>&lt;audio&gt;</InlineCode> element
      with stylised controls that respect reduced-motion preferences, expose clear
      focus states, and meet WCAG AAA contrast targets in both themes. It is fully
      keyboard accessible and announces playback state changes to assistive tech.
    </Paragraph>
    <Paragraph className="text-base text-slate-200">
      Supply metadata to create a full album-style layout or flip to the compact
      variant when you only need essential controls. Attach a WebVTT file to
      expose a collapsible, clickable transcript that stays synchronised with
      playback.
    </Paragraph>
  </section>

  <section class="mt-10 space-y-6">
    <Headline level="h2" textSize="xl" className="font-semibold text-slate-100"
      >Props</Headline
    >
    <div>
      <Table columns={propsColumns} data={propsData} responsive={true} />
    </div>
  </section>

  <section class="mt-10 space-y-6">
    <Headline level="h2" textSize="xl" className="font-semibold text-slate-100"
      >Usage</Headline
    >
    <Paragraph className="text-base text-slate-200">
      Import the component, pass the audio source, and optionally supply
      metadata for visual context. The player surfaces elapsed time, allows
      seeking, and exposes mute/play buttons that are keyboard accessible with
      clear focus rings.
    </Paragraph>
    <CodeBlock
      code={usageSnippet}
      language="astro"
      copyable={true}
      className="overflow-x-auto rounded-lg border border-slate-700/70 bg-slate-950/80 p-4 text-sm text-slate-50 shadow-inner"
    />
  </section>

  <section class="mt-10 space-y-8">
    <Headline level="h2" textSize="xl" className="font-semibold text-slate-100"
      >Examples</Headline
    >

    <article class="space-y-4">
      <div>
        <Headline
          level="h3"
          textSize="lg"
          className="font-semibold text-slate-100"
          >Full player with artwork</Headline
        >
        <Paragraph className="text-base text-slate-200">
          Pair title, artist, and cover art to create a rich album layout. The
          surface adapts seamlessly to dark mode while maintaining AAA contrast.
        </Paragraph>
      </div>
      <AudioPlayer
        src={fullTrack.src}
        title={fullTrack.title}
        artist={fullTrack.artist}
        cover={fullTrack.cover}
        className="max-w-xl"
      />
    </article>

    <article class="space-y-4">
      <div>
        <Headline
          level="h3"
          textSize="lg"
          className="font-semibold text-slate-100">Compact variant</Headline
        >
        <Paragraph className="text-base text-slate-200">
          Switch to <InlineCode>variant="compact"</InlineCode> when horizontal space
          is limited—such as episode lists or sticky footers. Add a cover to surface
          a square thumbnail ahead of the controls while keeping each button finger-friendly.
        </Paragraph>
      </div>
      <AudioPlayer
        src={compactTrack.src}
        title={compactTrack.title}
        artist={compactTrack.artist}
        cover={compactTrack.cover}
        variant="compact"
        className="max-w-lg"
      />
    </article>

    <article class="space-y-4">
      <div>
        <Headline
          level="h3"
          textSize="lg"
          className="font-semibold text-slate-100">Wide hero embed</Headline
        >
        <Paragraph className="text-base text-slate-200">
          Use <InlineCode>coverAspect="wide"</InlineCode> to feature a 16&thinsp;:&thinsp;9
          banner above the controls—ideal for live sessions, podcasts, or video highlights
          with cinematic artwork.
        </Paragraph>
      </div>
      <AudioPlayer
        src={wideTrack.src}
        title={wideTrack.title}
        artist={wideTrack.artist}
        cover={wideTrack.cover}
        coverAspect="wide"
        className="max-w-3xl"
      />
    </article>

    <article class="space-y-4">
      <div>
        <Headline
          level="h3"
          textSize="lg"
          className="font-semibold text-slate-100"
          >Transcript-enabled player</Headline
        >
        <Paragraph className="text-base text-slate-200">
          Provide a WebVTT file to unlock a collapsible transcript. Active lines
          highlight as the audio plays and users can click any cue to jump to
          that moment.
        </Paragraph>
      </div>
      <AudioPlayer
        src={fullTrack.src}
        title={fullTrack.title}
        artist={fullTrack.artist}
        cover={fullTrack.cover}
        captionsSrc={transcriptDataUrl}
        captionsLabel="Session transcript"
        className="max-w-xl"
      />
    </article>

    <article class="space-y-4">
      <div>
        <Headline
          level="h3"
          textSize="lg"
          className="font-semibold text-slate-100">Minimal player</Headline
        >
        <Paragraph className="text-base text-slate-200">
          Omit artwork and artist for lightweight embeds. The player still
          announces the track title to assistive technology via the internal <InlineCode
            >audio</InlineCode
          > label.
        </Paragraph>
      </div>
      <AudioPlayer
        src={bareTrack.src}
        title={bareTrack.title}
        loop
        className="max-w-md"
      />
    </article>
  </section>
</DocsLayout>
