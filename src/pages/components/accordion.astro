---
import DocsLayout from '../../layouts/DocsLayout.astro';
import Accordion from '../../components/Accordion.astro';
import Table from '../../components/Table.astro';
import Headline from '../../components/Headline.astro';
import Paragraph from '../../components/Paragraph.astro';
import CodeBlock from '../../components/CodeBlock.astro';
import InlineCode from '../../components/InlineCode.astro';

const overviewItems = [
  {
    id: 'accessibility',
    title: 'Accessible by default',
    content:
      '<p>Panels are announced with <strong>aria-expanded</strong> and <strong>aria-hidden</strong> so screen readers stay in sync.</p>',
  },
  {
    id: 'keyboard',
    title: 'Keyboard support',
    content:
      '<p>Each trigger is focusable and supports <strong>Space</strong> or <strong>Enter</strong> to toggle the content region.</p>',
  },
];

const multiItems = [
  {
    id: 'shipping',
    title: 'Shipping times',
    content:
      '<p>Most orders ship within 2 business days with tracked delivery.</p>',
  },
  {
    id: 'returns',
    title: 'Return policy',
    content:
      '<p>Returns are free within 30 days. Refunds are processed in 3–5 days.</p>',
  },
  {
    id: 'support',
    title: 'Support hours',
    content:
      '<p>Our team is available Monday through Friday from 8:00–18:00 (CET).</p>',
  },
];

const brandItems = [
  {
    id: 'vision',
    title: 'Our vision',
    content:
      '<p>Empower teams to build inclusive interfaces without starting from scratch.</p>',
  },
  {
    id: 'values',
    title: 'Brand values',
    content:
      '<p>Accessibility, reliability, and delightful defaults. Every detail is designed for AAA contrast.</p>',
  },
];

const htmlItems = [
  {
    id: 'html-1',
    title: 'Rich content: lists, links and markup',
    content: `
      <p>Accordions accept <strong>HTML strings</strong> for rich content. Use this when content
      comes from a trusted CMS or when you want to render formatted text:</p>
      <ul>
        <li><strong>Step 1:</strong> Prepare the content as HTML.</li>
        <li><strong>Step 2:</strong> Pass it in the <code>content</code> key and the component will render it.</li>
        <li><strong>Step 3:</strong> Ensure the source is sanitized server-side if it's user-provided.</li>
      </ul>
      <p>Example link: <a href="https://example.com" target="_blank" rel="noopener">External resource</a></p>
    `,
  },
  {
    id: 'html-2',
    title: 'Media and small blocks',
    content: `
      <p>Small rich blocks work well inside panels:</p>
      <figure class="my-2">
        <img src="https://images.unsplash.com/photo-1503023345310-bd7c1de61c7d?w=400&q=60" alt="Example" class="rounded" />
        <figcaption class="text-xs text-slate-400 mt-1">Example image</figcaption>
      </figure>
      <p>Use lists and markup for structured content.</p>
    `,
  },
];

const usageSnippet = `---
import { Accordion } from 'comet-astro';

const items = [
  { id: 'faq-1', title: 'Shipping', content: '<p>We ship worldwide from Germany.</p>' },
  { id: 'faq-2', title: 'Returns', content: '<p>Unopened items can be returned within 30 days.</p>' },
];

---

<Accordion items={items} multiple />`;
const propsColumns = [
  { key: 'name', label: 'Prop' },
  { key: 'type', label: 'Type' },
  { key: 'default', label: 'Default' },
  { key: 'description', label: 'Description' },
];

const propsData = [
  {
    name: 'items',
    type: 'Item[]',
    default: '[]',
    description:
      'Array of sections to render. Each item needs an id, title and optional HTML content.',
  },
  {
    name: 'multiple',
    type: 'boolean',
    default: 'false',
    description: 'Allow more than one panel to be open simultaneously.',
  },
  {
    name: 'openIds',
    type: 'string[]',
    default: '[]',
    description:
      'IDs of items that should be open on first render (useful for SSR).',
  },
  {
    name: 'className',
    type: 'string',
    default: "''",
    description:
      'Additional Tailwind utility classes to merge onto the wrapper. Internal elements expose BEM classes: Accordion, Accordion__Section, Accordion__Trigger, Accordion__Icon, Accordion__Panel, Accordion__PanelContent.',
  },
];
---

<DocsLayout
  seoTitle="Accordion"
  seoDescription="Disclosure/accordion with single or multiple open sections."
>
  <Headline level="h1" textSize="2xl">Accordion</Headline>
  <section class="space-y-4">
    <Paragraph class="text-base text-slate-100">
      The Accordion component provides an accessible, keyboard-friendly
      disclosure pattern for grouping related content. Triggers announce their
      state with
      <InlineCode>aria-expanded</InlineCode>, panels are hidden with
      <InlineCode>aria-hidden</InlineCode>, and reduced-motion preferences are
      respected. The component offers single- and multi-open modes plus simple
      styling hooks via BEM classes for brand overrides.
    </Paragraph>
    <Paragraph class="text-base text-slate-200">
      Typical use cases include FAQs, progressive disclosure in forms, compact
      help centers, or any scenario where users need to reveal and hide sections
      without losing context on the page.
    </Paragraph>
  </section>

  <section class="mt-10 space-y-6">
    <Headline level="h2" textSize="lg" weight="bold" className="text-slate-100"
      >Props</Headline
    >
    <div>
      <Table columns={propsColumns} data={propsData} responsive={true} />
    </div>
  </section>

  <section class="mt-10 space-y-6">
    <Headline level="h2" textSize="lg" weight="bold" className="text-slate-100"
      >Usage</Headline
    >
    <Paragraph class="text-base text-slate-200">
      Import the component and provide an array of items. Each item should
      contain an <InlineCode>id</InlineCode>, a <InlineCode>title</InlineCode>
      and optional <InlineCode>content</InlineCode>. The component is SSR-
      friendly so you can render initial open states with <InlineCode
        >openIds</InlineCode
      >. Content may be passed as HTML strings (rendered with <InlineCode
        >set:html</InlineCode
      >) — if that HTML originates from external sources, sanitize it
      server-side (example below).
    </Paragraph>
    <CodeBlock code={usageSnippet} language="astro" />

    <Headline
      level="h3"
      textSize="sm"
      weight="semibold"
      className="text-slate-100">Sanitizing HTML content</Headline
    >
    <Paragraph class="text-sm text-slate-400">
      If you render user-provided HTML inside panels, sanitize it on the server
      to avoid XSS. A lightweight example using <InlineCode
        >isomorphic-dompurify</InlineCode
      >:
    </Paragraph>
    <CodeBlock
      code={`import DOMPurify from 'isomorphic-dompurify';

export function sanitize(html) {
  return DOMPurify.sanitize(html);
}

// server-side
const safe = sanitize(userProvidedHtml);
// pass safe into Accordion items -> content
`}
      language="typescript"
    />
  </section>

  <section class="mt-10 space-y-8">
    <Headline level="h2" textSize="lg" weight="bold" className="text-slate-100"
      >Examples</Headline
    >

    <article class="space-y-4">
      <div>
        <Headline
          level="h3"
          textSize="lg"
          weight="semibold"
          className="text-slate-100">Single-open accordion (default)</Headline
        >
        <Paragraph class="text-base text-slate-200">
          Only one panel stays open at a time. Great for compact FAQ lists where
          people expect one answer per click. This mode helps reduce vertical
          scroll and keeps the interface concise.
        </Paragraph>
      </div>
      <Accordion items={overviewItems} openIds={['accessibility']} />
    </article>

    <article class="space-y-4">
      <div>
        <Headline
          level="h3"
          textSize="lg"
          weight="semibold"
          className="text-slate-100">Allow multiple panels</Headline
        >
        <Paragraph class="text-base text-slate-200">
          Set <InlineCode>multiple</InlineCode> when readers may want to compare answers
          or keep a checklist of steps open simultaneously. This is useful for longer
          forms, multi-step instructions, or side-by-side comparisons.
        </Paragraph>
      </div>
      <Accordion
        items={multiItems}
        multiple
        openIds={['shipping', 'returns']}
      />
    </article>

    <article class="space-y-4">
      <div>
        <Headline
          level="h3"
          textSize="lg"
          weight="semibold"
          className="text-slate-100">HTML content examples</Headline
        >
        <Paragraph class="text-base text-slate-200">
          Panels support rich HTML content. Pass a trusted HTML string to the
          <InlineCode>content</InlineCode> key; the component will render it with
          <InlineCode>set:html</InlineCode>. Sanitize user-provided HTML
          server-side.
        </Paragraph>
      </div>
      <Accordion items={htmlItems} />
    </article>

    <article class="space-y-6">
      <div>
        <Headline
          level="h3"
          textSize="lg"
          weight="semibold"
          className="text-slate-100">Styling &amp; overrides</Headline
        >
        <Paragraph class="text-base text-slate-200">
          Use <InlineCode>className</InlineCode> with the exposed BEM classes to apply
          brand surfaces or spacing tweaks. The example below targets the root BEM
          classes from outside the component, leaving the default Tailwind utilities
          in place.
        </Paragraph>
        <Paragraph class="text-sm text-slate-400">
          Available targets: <InlineCode>Accordion</InlineCode>, <InlineCode
            >Accordion__Section</InlineCode
          >, <InlineCode>Accordion__Trigger</InlineCode>, <InlineCode
            >Accordion__Icon</InlineCode
          >, <InlineCode>Accordion__Panel</InlineCode> und <InlineCode
            >Accordion__PanelContent</InlineCode
          >. Sie werden zwischen den Built-in-Utilities und deinem
          <InlineCode>className</InlineCode> gerendert, sodass deine Styles sauber
          überschreiben können.
        </Paragraph>
      </div>

      <div class="space-y-4">
        <Accordion items={brandItems} className="BrandAccordion" />

        <CodeBlock
          code={`const brandClassName = [
  'BrandAccordion',
].join(' ');

<Accordion items={items} className={brandClassName} />

<style>
  :global(.BrandAccordion.Accordion) {
    border-radius: 18px;
    padding: 1.25rem;
    background: radial-gradient(circle at 10% 20%, rgba(255, 191, 105, 0.12), transparent 35%),
      radial-gradient(circle at 80% 0%, rgba(73, 131, 255, 0.16), transparent 30%),
      linear-gradient(135deg, #0b1020 0%, #050710 100%);
    box-shadow: 0 20px 60px -30px rgba(0, 0, 0, 0.7);
  }
  :global(.BrandAccordion .Accordion__Section) {
    border: 1px solid rgba(245, 196, 110, 0.6);
    background: rgba(9, 10, 17, 0.82);
    backdrop-filter: blur(12px);
    box-shadow: 0 18px 50px -24px rgba(0, 0, 0, 0.65);
  }
  :global(.BrandAccordion .Accordion__Trigger) {
    background: transparent;
    color: #fef3c7;
    font-weight: 600;
  }
  :global(.BrandAccordion .Accordion__Trigger:hover) {
    background: rgba(15, 23, 42, 0.72);
  }
  :global(.BrandAccordion .Accordion__Trigger:focus-visible) {
    outline: 2px solid rgba(245, 196, 110, 0.75);
    outline-offset: 3px;
  }
  :global(.BrandAccordion .Accordion__Icon) {
    color: #fbbf24;
  }
  :global(.BrandAccordion .Accordion__Panel) {
    border-top: 1px solid rgba(245, 196, 110, 0.35);
  }
  :global(.BrandAccordion .Accordion__PanelContent) {
    color: #e2e8f0;
    line-height: 1.7;
  }
</style>
`}
          language="astro"
        />
      </div>
    </article>
  </section>
</DocsLayout>

<style>
  :global(.BrandAccordion.Accordion) {
    border-radius: 18px;
    padding: 1.25rem;
    background:
      radial-gradient(
        circle at 10% 20%,
        rgba(255, 191, 105, 0.12),
        transparent 35%
      ),
      radial-gradient(
        circle at 80% 0%,
        rgba(73, 131, 255, 0.16),
        transparent 30%
      ),
      linear-gradient(135deg, #0b1020 0%, #050710 100%);
    box-shadow: 0 20px 60px -30px rgba(0, 0, 0, 0.7);
  }
  :global(.BrandAccordion .Accordion__Section) {
    border: 1px solid rgba(245, 196, 110, 0.6);
    background: rgba(9, 10, 17, 0.82);
    backdrop-filter: blur(12px);
    box-shadow: 0 18px 50px -24px rgba(0, 0, 0, 0.65);
  }
  :global(.BrandAccordion .Accordion__Trigger) {
    background: transparent;
    color: #fef3c7;
    font-weight: 600;
  }
  :global(.BrandAccordion .Accordion__Trigger:hover) {
    background: rgba(15, 23, 42, 0.72);
  }
  :global(.BrandAccordion .Accordion__Trigger:focus-visible) {
    outline: 2px solid rgba(245, 196, 110, 0.75);
    outline-offset: 3px;
  }
  :global(.BrandAccordion .Accordion__Icon) {
    color: #fbbf24;
  }
  :global(.BrandAccordion .Accordion__Panel) {
    border-top: 1px solid rgba(245, 196, 110, 0.35);
  }
  :global(.BrandAccordion .Accordion__PanelContent) {
    color: #e2e8f0;
    line-height: 1.7;
  }
</style>
