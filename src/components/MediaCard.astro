---
/**
 * MediaCard - Card component with media support
 *
 * @deprecated This component is now a wrapper around UniversalCard.
 * Consider using UniversalCard directly for new code, which offers more features.
 *
 * @example
 * // Old usage (still works):
 * <MediaCard image="/img.jpg" title="Title" description="Desc" />
 *
 * // New recommended usage:
 * <UniversalCard imageSrc="/img.jpg" title="Title" description="Desc" />
 */
import UniversalCard, {
  type Action as UniversalAction,
} from './UniversalCard.astro';

interface Action {
  label: string;
  href?: string;
  onClick?: string;
  variant?: 'primary' | 'secondary' | 'danger';
  icon?: string;
  target?: '_blank' | '_self' | '_parent' | '_top';
}

interface Props {
  // Content
  image?: string;
  alt?: string;
  title: string;
  href?: string;
  description?: string;

  // Variants
  variant?: 'default' | 'horizontal' | 'minimal' | 'featured';
  size?: 'sm' | 'md' | 'lg';

  // Actions
  actions?: Action[];

  // States
  loading?: boolean;
  disabled?: boolean;

  // Visibility
  showImage?: boolean;
  showActions?: boolean;

  // Accessibility
  role?: string;
  ariaLabel?: string;
  ariaDescribedBy?: string;

  // Classes
  class?: string;
  className?: string;
}

const {
  image,
  alt = '',
  title,
  href,
  description,
  variant = 'default',
  size = 'md',
  actions = [],
  loading = false,
  disabled = false,
  showImage = true,
  showActions = true,
  role = 'article',
  ariaLabel,
  class: className,
  className: legacyClassName,
} = Astro.props;

// Map MediaCard variant to UniversalCard variant
const variantMap: Record<
  string,
  'vertical' | 'horizontal' | 'compact' | 'featured'
> = {
  default: 'vertical',
  horizontal: 'horizontal',
  minimal: 'compact',
  featured: 'featured',
};

// Map MediaCard actions to UniversalCard actions
const mappedActions: UniversalAction[] =
  showActions && actions.length > 0
    ? actions
        .filter((a): a is Action & { href: string } => !!a.href)
        .map((action) => ({
          href: action.href,
          label: action.label,
          variant:
            action.variant === 'danger'
              ? 'secondary'
              : action.variant || 'primary',
          target: action.target,
        }))
    : [];

// Determine elevation based on variant
const elevation = variant === 'minimal' ? 'none' : 'sm';

const finalClassName = className || legacyClassName || '';
---

<UniversalCard
  variant={variantMap[variant] || 'vertical'}
  size={size}
  elevation={elevation}
  href={href}
  imageSrc={showImage ? image : undefined}
  imageAlt={alt || title}
  title={title}
  description={description}
  actions={mappedActions}
  loading={loading}
  disabled={disabled}
  role={role}
  ariaLabel={ariaLabel}
  className={finalClassName}
/>
