---
import { cn } from '../utils/cn';

/**
 * Card - Simple container card component
 *
 * This is a lightweight wrapper that provides a styled container.
 * For cards with media, titles, actions, etc., use UniversalCard directly.
 *
 * @example
 * // Simple container usage:
 * <Card>Content here</Card>
 *
 * // With link:
 * <Card href="/page">Clickable card</Card>
 *
 * // For richer cards, use UniversalCard:
 * <UniversalCard title="Title" description="Desc" imageSrc="/img.jpg" />
 */
interface Props {
  /** Optional element tag name; defaults to 'article'. */
  as?: 'article' | 'section' | 'div' | 'li';
  /** Optional link target; turns card into an anchor element. */
  href?: string;
  /** Optional explicit aria-label when no visible heading is present. */
  ariaLabel?: string;
  /** Custom class names to extend styling. */
  class?: string;
  /** Disable shadow for flat appearance. */
  flat?: boolean;
  /** Elevation level (0-3) controlling shadow intensity. */
  elevation?: 0 | 1 | 2 | 3;
  /** Make card focusable even if not a link/button. */
  tabIndex?: number;
  /** Padding size */
  padding?: 'none' | 'sm' | 'md' | 'lg';
}

const {
  as = 'article',
  href,
  ariaLabel,
  class: className,
  flat = false,
  elevation = 1,
  tabIndex,
  padding = 'md',
} = Astro.props as Props;

// Map elevation to shadow utility classes
const elevationShadow = {
  0: 'shadow-none',
  1: 'shadow-sm',
  2: 'shadow-md',
  3: 'shadow-lg',
} as const;

// Padding classes
const paddingClasses = {
  none: '',
  sm: 'p-3',
  md: 'p-4',
  lg: 'p-6',
} as const;

// Base styling with WCAG AAA contrast
const base = cn(
  'group relative rounded-lg border',
  'bg-white dark:bg-slate-950',
  'border-slate-200 dark:border-slate-700',
  'text-slate-900 dark:text-slate-50',
  flat ? 'shadow-none' : elevationShadow[elevation],
  paddingClasses[padding]
);

// Focus ring for accessibility
const focusStyles = cn(
  'focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-600',
  'focus-visible:ring-offset-2 focus-visible:ring-offset-white',
  'dark:focus-visible:ring-blue-400 dark:focus-visible:ring-offset-slate-950'
);

// Interactive styles if href provided
const interactive = href
  ? cn(
      'cursor-pointer transition-all duration-200',
      'hover:shadow-md hover:border-slate-300 dark:hover:border-slate-600',
      'hover:-translate-y-0.5'
    )
  : '';

// Decide which element to render
const Tag = href ? 'a' : as;

// Accessibility attributes
const ariaAttrs: Record<string, string | undefined> = {};
if (ariaLabel) ariaAttrs['aria-label'] = ariaLabel;
---

<Tag
  class={cn(base, focusStyles, interactive, className)}
  href={href}
  tabindex={tabIndex}
  {...ariaAttrs}
>
  <slot />
</Tag>
